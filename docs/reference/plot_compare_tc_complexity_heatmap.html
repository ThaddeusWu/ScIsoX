<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create heatmaps for transcriptome complexity metrics across groups using ComplexHeatmap — plot_compare_tc_complexity_heatmap • ScIsoX</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Create heatmaps for transcriptome complexity metrics across groups using ComplexHeatmap — plot_compare_tc_complexity_heatmap"><meta name="description" content="This function creates heatmaps for visualising multiple complexity metrics
across different groups or conditions. It can also show changes in metrics
between consecutive groups. The function supports different methods for
selecting genes to display."><meta property="og:description" content="This function creates heatmaps for visualising multiple complexity metrics
across different groups or conditions. It can also show changes in metrics
between consecutive groups. The function supports different methods for
selecting genes to display."><meta property="og:image" content="https://ThaddeusWu.github.io/ScIsoX/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-#1a5490" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ScIsoX</a>

    <small class="nav-text text-success me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/vignette-01-getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-02-data-import-qc.html">Data Import and QC</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-03-complexity-metrics.html">Complexity Metrics</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-04-visualisation.html">Visualisation Gallery</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-05-coexpression.html">Co-expression Analysis</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ThaddeusWu/ScIsoX/releases/tag/v1.1.3">Version 1.1.3</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ThaddeusWu/ScIsoX/releases/tag/v1.1.2">Version 1.1.2</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ThaddeusWu/ScIsoX/releases/tag/v1.1.1">Version 1.1.1</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ThaddeusWu/ScIsoX/releases/tag/V1.1.0">Version 1.1.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ThaddeusWu/ScIsoX/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create heatmaps for transcriptome complexity metrics across groups using ComplexHeatmap</h1>
      <small class="dont-index">Source: <a href="https://github.com/ThaddeusWu/ScIsoX/blob/HEAD/R/visualisation_analysis.R" class="external-link"><code>R/visualisation_analysis.R</code></a></small>
      <div class="d-none name"><code>plot_compare_tc_complexity_heatmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function creates heatmaps for visualising multiple complexity metrics
across different groups or conditions. It can also show changes in metrics
between consecutive groups. The function supports different methods for
selecting genes to display.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_compare_tc_complexity_heatmap</span><span class="op">(</span></span>
<span>  <span class="va">tc_results_list</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"intra_cellular_isoform_diversity"</span>, <span class="st">"inter_cellular_isoform_diversity"</span>,</span>
<span>    <span class="st">"intra_cell_type_heterogeneity"</span>, <span class="st">"inter_cell_type_specificity"</span>,</span>
<span>    <span class="st">"intra_cell_type_heterogeneity_variability"</span>,</span>
<span>    <span class="st">"inter_cell_type_difference_variability"</span>, <span class="st">"cell_type_coexpression_variability"</span><span class="op">)</span>,</span>
<span>  n_top_genes <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  selection_method <span class="op">=</span> <span class="st">"variance"</span>,</span>
<span>  custom_genes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cluster_genes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_changes <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tc-results-list">tc_results_list<a class="anchor" aria-label="anchor" href="#arg-tc-results-list"></a></dt>
<dd><p>List of transcriptomic complexity results objects</p></dd>


<dt id="arg-groups">groups<a class="anchor" aria-label="anchor" href="#arg-groups"></a></dt>
<dd><p>Vector of names for each group (if NULL, generic names are used)</p></dd>


<dt id="arg-metrics">metrics<a class="anchor" aria-label="anchor" href="#arg-metrics"></a></dt>
<dd><p>Vector of metric names to include in heatmaps</p></dd>


<dt id="arg-n-top-genes">n_top_genes<a class="anchor" aria-label="anchor" href="#arg-n-top-genes"></a></dt>
<dd><p>Number of top genes to include in heatmaps</p></dd>


<dt id="arg-selection-method">selection_method<a class="anchor" aria-label="anchor" href="#arg-selection-method"></a></dt>
<dd><p>Method for selecting genes ("variance", "magnitude", or "custom")</p></dd>


<dt id="arg-custom-genes">custom_genes<a class="anchor" aria-label="anchor" href="#arg-custom-genes"></a></dt>
<dd><p>Vector of custom gene names to use when selection_method is "custom"</p></dd>


<dt id="arg-cluster-genes">cluster_genes<a class="anchor" aria-label="anchor" href="#arg-cluster-genes"></a></dt>
<dd><p>Whether to cluster genes in heatmaps</p></dd>


<dt id="arg-show-changes">show_changes<a class="anchor" aria-label="anchor" href="#arg-show-changes"></a></dt>
<dd><p>Whether to create separate heatmaps showing changes between groups</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing:</p>
<dl><dt>heatmaps</dt>
<dd><p>List of ComplexHeatmap objects for each metric</p></dd>

<dt>change_heatmaps</dt>
<dd><p>List of ComplexHeatmap objects showing changes between groups</p></dd>

<dt>metric_matrices</dt>
<dd><p>List of matrices with metric values</p></dd>

<dt>change_matrices</dt>
<dd><p>List of matrices with change values</p></dd>

<dt>top_genes</dt>
<dd><p>Vector of selected gene names</p></dd>

<dt>selection_method</dt>
<dd><p>Method used for gene selection</p></dd>

</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># This example requires multiple conditions/datasets  </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">gene_counts_blood</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">transcript_counts_blood</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">transcript_info</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sample2stage</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create SCHT</span></span></span>
<span class="r-in"><span><span class="va">scht_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="create_scht.html">create_scht</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  gene_counts <span class="op">=</span> <span class="va">gene_counts_blood</span>,</span></span>
<span class="r-in"><span>  transcript_counts <span class="op">=</span> <span class="va">transcript_counts_blood</span>,</span></span>
<span class="r-in"><span>  transcript_info <span class="op">=</span> <span class="va">transcript_info</span>,</span></span>
<span class="r-in"><span>  cell_info <span class="op">=</span> <span class="va">sample2stage</span>,</span></span>
<span class="r-in"><span>  qc_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    min_genes_per_cell <span class="op">=</span> <span class="fl">4000</span>,       </span></span>
<span class="r-in"><span>    max_genes_per_cell <span class="op">=</span> <span class="fl">10000</span>,      </span></span>
<span class="r-in"><span>    min_cells_expressing <span class="op">=</span> <span class="fl">0.02</span>,   </span></span>
<span class="r-in"><span>    min_expr <span class="op">=</span> <span class="fl">1e-6</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  n_hvg <span class="op">=</span> <span class="fl">3000</span>,</span></span>
<span class="r-in"><span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate metrics</span></span></span>
<span class="r-in"><span><span class="va">tc_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_isoform_complexity_metrics.html">calculate_isoform_complexity_metrics</a></span><span class="op">(</span><span class="va">scht_obj</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For demonstration, create a list with the same results</span></span></span>
<span class="r-in"><span><span class="va">tc_results_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  baseline <span class="op">=</span> <span class="va">tc_results</span>,</span></span>
<span class="r-in"><span>  treatment <span class="op">=</span> <span class="va">tc_results</span>  <span class="co"># In practice, these would be different</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span>                        </span></span>
<span class="r-in"><span><span class="co"># Create heatmaps with default settings</span></span></span>
<span class="r-in"><span><span class="va">heatmap_results</span> <span class="op">&lt;-</span> <span class="fu">plot_compare_tc_complexity_heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">tc_results_list</span>, </span></span>
<span class="r-in"><span>  groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Baseline"</span>, <span class="st">"Treatment"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span>                  </span></span>
<span class="r-in"><span><span class="co"># Display the first heatmap if ComplexHeatmap is available</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ComplexHeatmap"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">heatmap_results</span><span class="op">$</span><span class="va">heatmaps</span><span class="op">$</span><span class="va">intra_cellular_isoform_diversity</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Siyuan Wu, Ulf Schmitz<br> Site built with <a href="https://pkgdown.r-lib.org" class="external-link">pkgdown</a> 2.1.1</p>
</div>

<div class="pkgdown-footer-right">
  <p><strong>Package License</strong>: <a href="https://opensource.org/licenses/MIT" class="external-link">MIT</a><br><br><strong>Example Data Attribution</strong>:<br> The example datasets included in this package are derived from:<br> Wang et al. (2022). Single-cell architecture and functional requirement of alternative splicing during hematopoietic stem cell formation. <em>Science Advances</em> 8(1):eabg5369<br> Licensed under <a href="https://creativecommons.org/licenses/by/4.0/" class="external-link">CC BY 4.0</a><br> We gratefully acknowledge the authors for making their data publicly available.</p>
</div>

    </footer></div>





  </body></html>

