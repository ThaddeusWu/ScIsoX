<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>ScIsoX • ScIsoX</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<meta property="og:title" content="ScIsoX">
<meta name="description" content="A comprehensive R package for measuring isoform-level transcriptomic
complexity in single cells. ScIsoX provides a robust computational
framework for investigating alternative splicing patterns at
single-cell resolution.
">
<meta property="og:description" content="A comprehensive R package for measuring isoform-level transcriptomic
complexity in single cells. ScIsoX provides a robust computational
framework for investigating alternative splicing patterns at
single-cell resolution.
">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-#1a5490" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ScIsoX</a>

    <small class="nav-text text-success me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="articles/vignette-01-getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="articles/vignette-02-data-import-qc.html">Data Import and QC</a></li>
    <li><a class="dropdown-item" href="articles/vignette-03-complexity-metrics.html">Complexity Metrics</a></li>
    <li><a class="dropdown-item" href="articles/vignette-04-visualisation.html">Visualisation Gallery</a></li>
    <li><a class="dropdown-item" href="articles/vignette-05-coexpression.html">Co-expression Analysis</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ThaddeusWu/ScIsoX/releases/tag/v1.1.1">Version 1.1.1</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ThaddeusWu/ScIsoX/releases/tag/V1.1.0">Version 1.1.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ThaddeusWu/ScIsoX/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="scisox">ScIsoX<a class="anchor" aria-label="anchor" href="#scisox"></a>
</h1></div>
<p><a href="https://opensource.org/licenses/MIT" class="external-link"><img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT"></a> <a href="https://github.com/ThaddeusWu/ScIsoX" class="external-link"><img src="https://img.shields.io/badge/Version-1.1.1-blue.svg" alt="Version"></a> <a href="https://www.r-project.org/" class="external-link"><img src="https://img.shields.io/badge/R-%3E%3D%204.0.0-blue.svg" alt="R"></a> <a href="https://doi.org/10.5281/zenodo.16569859" class="external-link"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.16569859.svg" alt="DOI"></a></p>
<div class="section level2">
<h2 id="single-cell-hierarchical-tensor-scht-creation-pipeline-and-transcriptomic-complexity-analysis-in-r">Single-Cell Hierarchical Tensor (SCHT) Creation Pipeline and Transcriptomic Complexity Analysis in R<a class="anchor" aria-label="anchor" href="#single-cell-hierarchical-tensor-scht-creation-pipeline-and-transcriptomic-complexity-analysis-in-r"></a>
</h2>
<p><em>A comprehensive toolkit for analysing isoform expression patterns at single-cell resolution</em></p>
<pre><code>Wu S and Schmitz U (2025). ScIsoX: A Multidimensional Framework for Measuring Isoform-Level Transcriptomic Complexity in Single Cells.</code></pre>
<hr>
</div>
<div class="section level2">
<h2 id="table-of-contents">Table of Contents<a class="anchor" aria-label="anchor" href="#table-of-contents"></a>
</h2>
<ol style="list-style-type: decimal">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#package-architecture">Package Architecture</a></li>
<li><a href="#id_5-minute-quick-start">5-Minute Quick Start</a></li>
<li><a href="#basic-tutorial">Basic Tutorial</a></li>
<li><a href="#advanced-usage">Advanced Usage</a></li>
<li><a href="#visualisation-gallery">Visualisation Gallery</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
<li><a href="#citation">Citation</a></li>
<li><a href="#contact--support">Contact &amp; Support</a></li>
</ol>
<hr>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>ScIsoX provides a robust computational framework for investigating transcriptomic complexity at single-cell resolution. The package enables researchers to analyse alternative splicing patterns across cell types, revealing cell type-specific isoform usage and co-expression dynamics.</p>
<div class="section level3">
<h3 id="key-features">Key Features<a class="anchor" aria-label="anchor" href="#key-features"></a>
</h3>
<ul>
<li>
<strong>Single-Cell Hierarchical Tensor</strong>: Generate multi-dimensional representation of isoform expression</li>
<li>
<strong>Complexity Analysis</strong>: Calculate seven core complexity metrics that capture different aspects of transcriptomic diversity</li>
<li>
<strong>Advanced Visualisations</strong>: Create advanced figures for complexity analysis with 13+ specialised plotting functions</li>
<li>
<strong>Cell Type Comparison</strong>: Analyse cell type-specific isoform usage patterns</li>
<li>
<strong>Co-expression Analysis</strong>: Interactive Shiny application for exploring isoform relationships</li>
<li>
<strong>Performance Tracking</strong>: Built-in memory and runtime monitoring with sparsity analysis</li>
</ul>
</div>
<div class="section level3">
<h3 id="theoretical-framework">Theoretical Framework<a class="anchor" aria-label="anchor" href="#theoretical-framework"></a>
</h3>
<p>ScIsoX implements a novel analytical framework based on hierarchical tensor decomposition to quantify transcriptomic complexity across multiple dimensions. The seven core metrics capture:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Intra-cellular isoform diversity</strong>: Co-expression of multiple isoforms within individual cells</li>
<li>
<strong>Inter-cellular isoform diversity</strong>: Distribution of different isoforms across the cellular population</li>
<li>
<strong>Intra-cell-type heterogeneity</strong>: Cell-to-cell variation in isoform usage within a cell type</li>
<li>
<strong>Inter-cell-type specificity</strong>: Cell-type-specific patterns of isoform usage</li>
<li>
<strong>Intra-cell-type heterogeneity variability</strong>: Variation in cellular heterogeneity across cell types</li>
<li>
<strong>Inter-cell-type difference variability</strong>: Identification of cell type pairs with distinctive isoform usage</li>
<li>
<strong>Cell-type-specific co-expression variability</strong>: Variation in cellular co-expression mechanisms across cell types</li>
</ol>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="section level3">
<h3 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h3>
<p>ScIsoX requires R version 4.0.0 or higher and depends on several packages for efficient data processing and visualisation.</p>
</div>
<div class="section level3">
<h3 id="from-github">From GitHub<a class="anchor" aria-label="anchor" href="#from-github"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install devtools if not already installed</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"devtools"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Install ScIsoX</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"ThaddeusWu/ScIsoX"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="first-time-setup">First Time Setup<a class="anchor" aria-label="anchor" href="#first-time-setup"></a>
</h3>
<p>When you first load ScIsoX, it will check for optional packages and provide helpful information:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ThaddeusWu.github.io/ScIsoX/">ScIsoX</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># If some optional packages are missing, you'll see:</span></span>
<span><span class="co"># ===============================================</span></span>
<span><span class="co"># ScIsoX: Single-Cell Isoform Complexity Analysis</span></span>
<span><span class="co"># ===============================================</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Some optional packages are not installed:</span></span>
<span><span class="co">#   - For visualisation: ggridges, ggrepel, ggExtra</span></span>
<span><span class="co">#   - For advanced_plots: ComplexHeatmap, ggradar, cowplot, patchwork</span></span>
<span><span class="co">#   - For data_manipulation: tidyr</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Some visualisation features may not be available.</span></span>
<span><span class="co"># To install all optional packages, run:</span></span>
<span><span class="co">#   install_scisox_suggests()</span></span>
<span></span>
<span><span class="co"># Install all optional packages with one command:</span></span>
<span><span class="fu"><a href="reference/install_scisox_suggests.html">install_scisox_suggests</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Or install only specific types:</span></span>
<span><span class="fu"><a href="reference/install_scisox_suggests.html">install_scisox_suggests</a></span><span class="op">(</span>include_bioc <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  <span class="co"># Skip Bioconductor packages</span></span>
<span><span class="fu"><a href="reference/install_scisox_suggests.html">install_scisox_suggests</a></span><span class="op">(</span>include_github <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  <span class="co"># Skip GitHub packages</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h3>
<p>ScIsoX requires several R packages to function properly. Below is a comprehensive list of all dependencies:</p>
<div class="section level4">
<h4 id="required-dependencies-imports">Required Dependencies (Imports)<a class="anchor" aria-label="anchor" href="#required-dependencies-imports"></a>
</h4>
<p>These packages will be automatically installed when you install ScIsoX:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Core dependencies</span></span>
<span><span class="va">required_packages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"progress"</span>,   <span class="co"># For progress bars</span></span>
<span>  <span class="st">"stats"</span>,      <span class="co"># For statistical functions</span></span>
<span>  <span class="st">"graphics"</span>,   <span class="co"># For base plotting</span></span>
<span>  <span class="st">"grDevices"</span>,  <span class="co"># For graphics devices and colours</span></span>
<span>  <span class="st">"rtracklayer"</span>, <span class="co"># For handling GTF files</span></span>
<span>  <span class="st">"tools"</span>,      <span class="co"># For file utilities</span></span>
<span>  <span class="st">"data.table"</span>, <span class="co"># For efficient data manipulation</span></span>
<span>  <span class="st">"Matrix"</span>,     <span class="co"># For sparse matrix support</span></span>
<span>  <span class="st">"methods"</span>,    <span class="co"># For S3/S4 method handling</span></span>
<span>  <span class="st">"dplyr"</span>,      <span class="co"># For data manipulation</span></span>
<span>  <span class="st">"mclust"</span>,     <span class="co"># For clustering and mixture models</span></span>
<span>  <span class="st">"ggplot2"</span>,    <span class="co"># For plotting</span></span>
<span>  <span class="st">"moments"</span>,    <span class="co"># For statistical moments calculation</span></span>
<span>  <span class="st">"utils"</span>,      <span class="co"># For utility functions</span></span>
<span>  <span class="st">"knitr"</span>,      <span class="co"># For documentation</span></span>
<span>  <span class="st">"car"</span>,        <span class="co"># For statistical transformations</span></span>
<span>  <span class="st">"diptest"</span>,    <span class="co"># For multimodality tests</span></span>
<span>  <span class="st">"scales"</span>,     <span class="co"># For scale transformations</span></span>
<span>  <span class="st">"gridExtra"</span>,  <span class="co"># For arranging multiple plots</span></span>
<span>  <span class="st">"magrittr"</span>,   <span class="co"># For pipe operations</span></span>
<span>  <span class="st">"MASS"</span>,       <span class="co"># For statistical functions</span></span>
<span>  <span class="st">"viridis"</span>,    <span class="co"># For colour palettes (frequently used)</span></span>
<span>  <span class="st">"RColorBrewer"</span>, <span class="co"># For colour palettes (frequently used)</span></span>
<span>  <span class="st">"shiny"</span>,      <span class="co"># For interactive applications</span></span>
<span>  <span class="st">"shinydashboard"</span>, <span class="co"># For Shiny dashboard layouts</span></span>
<span>  <span class="st">"plotly"</span>,     <span class="co"># For interactive plots</span></span>
<span>  <span class="st">"DT"</span>          <span class="co"># For interactive data tables</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># These are automatically installed with ScIsoX</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="optional-dependencies-suggests">Optional Dependencies (Suggests)<a class="anchor" aria-label="anchor" href="#optional-dependencies-suggests"></a>
</h4>
<p>These packages provide enhanced functionality. <strong>ScIsoX is designed to work without these packages</strong>, but some visualisations and features will have reduced functionality:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Optional packages for advanced visualisations</span></span>
<span><span class="va">suggested_packages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"ggridges"</span>,         <span class="co"># For ridge plots (required for plot_complexity_ridges)</span></span>
<span>  <span class="st">"ggrepel"</span>,          <span class="co"># For repelling text labels (falls back to regular text)</span></span>
<span>  <span class="st">"ggExtra"</span>,          <span class="co"># For marginal plots (skipped if not available)</span></span>
<span>  <span class="st">"ComplexHeatmap"</span>,   <span class="co"># For heatmaps (required for plot_isoform_coexpression)</span></span>
<span>  <span class="st">"cowplot"</span>,          <span class="co"># For plot composition (required for multi-panel layouts)</span></span>
<span>  <span class="st">"grid"</span>,             <span class="co"># For advanced graphics</span></span>
<span>  <span class="st">"tidyr"</span>,            <span class="co"># For data reshaping (falls back to base R reshape)</span></span>
<span>  <span class="st">"circlize"</span>,         <span class="co"># For colour palettes in heatmaps</span></span>
<span>  <span class="st">"patchwork"</span>         <span class="co"># For combining plots</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Quick Installation:</strong> ScIsoX provides a convenient function to install all optional packages:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># After installing ScIsoX, run:</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ThaddeusWu.github.io/ScIsoX/">ScIsoX</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/install_scisox_suggests.html">install_scisox_suggests</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="other-packages">Other Packages<a class="anchor" aria-label="anchor" href="#other-packages"></a>
</h4>
<p>Some advanced features require packages:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install devtools if needed</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"devtools"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Install ggradar for radar charts</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ggradar"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"ricardo-bion/ggradar"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Install ComplexHeatmap for heat maps</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://bioconductor.github.io/BiocManager/" class="external-link">"BiocManager"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"ComplexHeatmap"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="package-behaviour-with-missing-dependencies">Package Behaviour with Missing Dependencies<a class="anchor" aria-label="anchor" href="#package-behaviour-with-missing-dependencies"></a>
</h4>
<p>ScIsoX is designed to be robust when optional packages are not installed:</p>
<ul>
<li>
<strong>Core functionality always works</strong>: All complexity calculations and basic analyses</li>
<li>
<strong>Graceful degradation</strong>: When optional packages are missing:
<ul>
<li>
<code>ggrepel</code>: Labels use standard text positioning</li>
<li>
<code>ggExtra</code>: Marginal distributions are skipped</li>
<li>
<code>tidyr</code>: Base R reshape functions are used</li>
<li>Colour palettes: Built-in alternatives are provided</li>
</ul>
</li>
<li>
<strong>Clear error messages</strong>: Functions requiring specific packages will provide installation instructions</li>
<li>
<strong>Startup messages</strong>: When loading ScIsoX, you’ll see which optional packages are missing</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: Using ScIsoX without all optional packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ThaddeusWu.github.io/ScIsoX/">ScIsoX</a></span><span class="op">)</span></span>
<span><span class="co"># You'll see a message about missing packages and how to install them</span></span>
<span></span>
<span><span class="co"># The core analysis still works perfectly:</span></span>
<span><span class="co"># First create SCHT object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">gene_counts_blood</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">transcript_counts_blood</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">transcript_info</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sample2stage</span><span class="op">)</span></span>
<span></span>
<span><span class="va">scht_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/create_scht.html">create_scht</a></span><span class="op">(</span></span>
<span>  gene_counts <span class="op">=</span> <span class="va">gene_counts_blood</span>,</span>
<span>  transcript_counts <span class="op">=</span> <span class="va">transcript_counts_blood</span>,</span>
<span>  transcript_info <span class="op">=</span> <span class="va">transcript_info</span>,</span>
<span>  cell_info <span class="op">=</span> <span class="va">sample2stage</span>,</span>
<span>  n_hvg <span class="op">=</span> <span class="fl">3000</span>,</span>
<span>  qc_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    min_genes_per_cell <span class="op">=</span> <span class="fl">4000</span>,       </span>
<span>    max_genes_per_cell <span class="op">=</span> <span class="fl">10000</span>,      </span>
<span>    min_cells_expressing <span class="op">=</span> <span class="fl">0.02</span>,   </span>
<span>    min_expr <span class="op">=</span> <span class="fl">1e-6</span></span>
<span>  <span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">tc_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/calculate_isoform_complexity_metrics.html">calculate_isoform_complexity_metrics</a></span><span class="op">(</span><span class="va">scht_obj</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Some visualisations may have reduced features:</span></span>
<span><span class="fu"><a href="reference/plot_tc_landscape.html">plot_tc_landscape</a></span><span class="op">(</span><span class="va">tc_results</span><span class="op">)</span>  <span class="co"># Works, but labels might overlap without ggrepel</span></span></code></pre></div>
<p>Note: For the best experience, we recommend installing all suggested packages using <code><a href="reference/install_scisox_suggests.html">install_scisox_suggests()</a></code>.</p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="package-architecture">Package Architecture<a class="anchor" aria-label="anchor" href="#package-architecture"></a>
</h2>
<p>ScIsoX is organised into several functional modules:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Data Import &amp; Preprocessing</strong>
<ul>
<li>
<code><a href="reference/create_transcript_info.html">create_transcript_info()</a></code>: Generate standardised transcript annotations from GTF files</li>
<li>
<code><a href="reference/generate_gene_counts.html">generate_gene_counts()</a></code>: Create gene-level counts from isoform-level expression data</li>
<li>
<code><a href="reference/plot_genes_per_cell_distribution.html">plot_genes_per_cell_distribution()</a></code>: Visualise and analyse genes per cell distribution</li>
<li>
<code><a href="reference/recommend_qc_parameters.html">recommend_qc_parameters()</a></code>: Generate data-driven QC parameter recommendations</li>
</ul>
</li>
<li>
<strong>SCHT Creation Pipeline</strong>
<ul>
<li>
<code><a href="reference/create_scht.html">create_scht()</a></code>: Process raw count data into Single-Cell Hierarchical Tensor objects with automatic sparsity detection</li>
</ul>
</li>
<li>
<strong>Complexity Analysis</strong>
<ul>
<li>
<code><a href="reference/calculate_isoform_complexity_metrics.html">calculate_isoform_complexity_metrics()</a></code>: Calculate all seven core complexity metrics</li>
<li>
<code><a href="reference/select_genes_of_interest.html">select_genes_of_interest()</a></code>: Filter genes based on complexity classifications</li>
<li>
<code><a href="reference/find_complexity_pattern.html">find_complexity_pattern()</a></code>: Identify genes with specific complexity patterns</li>
<li>
<code><a href="reference/compare_gene_metrics.html">compare_gene_metrics()</a></code>: Extract and compare metrics across multiple genes</li>
</ul>
</li>
<li>
<strong>Visualisation &amp; Exploration (13+ specialised functions)</strong>
<ul>
<li>
<code><a href="reference/plot_threshold_visualisations.html">plot_threshold_visualisations()</a></code>: Create bar charts for comparing distributions and threshold choices across different complexity metrics</li>
<li>
<code><a href="reference/plot_tc_landscape.html">plot_tc_landscape()</a></code>: Create complexity landscape plots with marginal distributions</li>
<li>
<code><a href="reference/plot_tc_density.html">plot_tc_density()</a></code>: Generate contour plots for complexity landscapes</li>
<li>
<code><a href="reference/plot_diversity_comparison.html">plot_diversity_comparison()</a></code>: Compare intra-cellular and inter-cellular diversity</li>
<li>
<code><a href="reference/plot_complexity_ridges.html">plot_complexity_ridges()</a></code>: Create ridge plots for complexity metrics</li>
<li>
<code><a href="reference/plot_isoform_coexpression.html">plot_isoform_coexpression()</a></code>: Visualise co-expression patterns between isoforms</li>
<li>
<code><a href="reference/plot_isoform_profile.html">plot_isoform_profile()</a></code>: Create stacked bar charts of isoform usage across cell types</li>
<li>
<code><a href="reference/plot_isoform_transitions.html">plot_isoform_transitions()</a></code>: Visualise isoform usage transitions across cell types</li>
<li>
<code><a href="reference/plot_complexity_radar.html">plot_complexity_radar()</a></code>: Create radar charts for multi-dimensional complexity comparison</li>
<li>
<code><a href="reference/plot_single_gene_radar_cell_type.html">plot_single_gene_radar_cell_type()</a></code>: Create radar chart for a single gene across cell types</li>
<li>
<code><a href="reference/plot_compare_multiple_genes_radar_cell_type.html">plot_compare_multiple_genes_radar_cell_type()</a></code>: Compare multiple genes across cell types with radar charts</li>
<li>
<code><a href="reference/plot_compare_tc_density_difference.html">plot_compare_tc_density_difference()</a></code>: Compare complexity density differences between groups</li>
<li>
<code><a href="reference/plot_compare_tc_complexity_heatmap.html">plot_compare_tc_complexity_heatmap()</a></code>: Create comparative heatmaps of complexity differences</li>
</ul>
</li>
<li>
<strong>Co-expression Analysis Suite</strong>
<ul>
<li>
<code><a href="reference/calculate_isoform_coexpression.html">calculate_isoform_coexpression()</a></code>: Core correlation calculation for single genes</li>
<li>
<code><a href="reference/calculate_gene_coexpression_all_celltypes.html">calculate_gene_coexpression_all_celltypes()</a></code>: Multi-cell type correlation analysis</li>
<li>
<code><a href="reference/analyse_coexpression_conservation.html">analyse_coexpression_conservation()</a></code>: Identifies conserved vs cell-type-specific patterns</li>
<li>
<code><a href="reference/detect_isoform_switching.html">detect_isoform_switching()</a></code>: Identifies antagonistic isoform relationships</li>
<li>
<code><a href="reference/launch_coexpression_app.html">launch_coexpression_app()</a></code>: Interactive Shiny application for exploration</li>
</ul>
</li>
<li>
<strong>Performance &amp; Quality Control</strong>
<ul>
<li>
<code><a href="reference/calculate_scht_sparsity.html">calculate_scht_sparsity()</a></code>: Analyse memory efficiency of SCHT structures</li>
<li>
<code><a href="reference/generate_qc_report.html">generate_qc_report()</a></code>: Generate comprehensive QC reports</li>
</ul>
</li>
</ol>
<hr>
</div>
<div class="section level2">
<h2 id="id_5-minute-quick-start">5-Minute Quick Start<a class="anchor" aria-label="anchor" href="#id_5-minute-quick-start"></a>
</h2>
<p>Want to get started quickly? Here’s a minimal example using the included example data:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load ScIsoX</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ThaddeusWu.github.io/ScIsoX/">ScIsoX</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load example data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">gene_counts_blood</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">transcript_counts_blood</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">transcript_info</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sample2stage</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create SCHT object with recommended parameters</span></span>
<span><span class="va">scht_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/create_scht.html">create_scht</a></span><span class="op">(</span></span>
<span>  gene_counts <span class="op">=</span> <span class="va">gene_counts_blood</span>,</span>
<span>  transcript_counts <span class="op">=</span> <span class="va">transcript_counts_blood</span>,</span>
<span>  transcript_info <span class="op">=</span> <span class="va">transcript_info</span>,</span>
<span>  cell_info <span class="op">=</span> <span class="va">sample2stage</span>,</span>
<span>  qc_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    min_genes_per_cell <span class="op">=</span> <span class="fl">4000</span>,</span>
<span>    max_genes_per_cell <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>    min_cells_expressing <span class="op">=</span> <span class="fl">0.02</span>,</span>
<span>    min_expr <span class="op">=</span> <span class="fl">1e-6</span></span>
<span>  <span class="op">)</span>,</span>
<span>  n_hvg <span class="op">=</span> <span class="fl">3000</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate complexity metrics</span></span>
<span><span class="va">tc_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/calculate_isoform_complexity_metrics.html">calculate_isoform_complexity_metrics</a></span><span class="op">(</span><span class="va">scht_obj</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualise complexity landscape</span></span>
<span><span class="fu"><a href="reference/plot_tc_landscape.html">plot_tc_landscape</a></span><span class="op">(</span><span class="va">tc_results</span>, n_label <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find genes with high complexity</span></span>
<span><span class="va">complex_genes</span> <span class="op">&lt;-</span> <span class="va">tc_results</span><span class="op">$</span><span class="va">metrics</span><span class="op">[</span></span>
<span>  <span class="va">tc_results</span><span class="op">$</span><span class="va">metrics</span><span class="op">$</span><span class="va">intra_cellular_isoform_diversity_class</span> <span class="op">==</span> <span class="st">"high"</span> <span class="op">&amp;</span></span>
<span>  <span class="va">tc_results</span><span class="op">$</span><span class="va">metrics</span><span class="op">$</span><span class="va">inter_cellular_isoform_diversity_class</span> <span class="op">==</span> <span class="st">"high"</span>,</span>
<span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Found"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">complex_genes</span><span class="op">)</span>, <span class="st">"highly complex genes"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Launch interactive co-expression app (optional)</span></span>
<span><span class="co"># launch_coexpression_app(scht_obj)</span></span></code></pre></div>
<p>That’s it! You’ve just: - Created a Single-Cell Hierarchical Tensor (SCHT) - Calculated transcriptomic complexity metrics - Visualised the complexity landscape - Identified highly complex genes</p>
<p>For more details, continue to the tutorials below.</p>
<hr>
</div>
<div class="section level2">
<h2 id="basic-tutorial">Basic Tutorial<a class="anchor" aria-label="anchor" href="#basic-tutorial"></a>
</h2>
<div class="section level3">
<h3 id="input-data-recommendations">Input data recommendations<a class="anchor" aria-label="anchor" href="#input-data-recommendations"></a>
</h3>
<p>The accuracy of <em>ScIsoX</em>’s complexity metrics is contingent upon the quality of the input isoform-by-cell count matrix. Users should be aware that artefacts from library preparation, sequencing errors, or read misalignment can lead to the spurious identification of transcripts, potentially inflating complexity metrics. Rigorous upstream quality control and filtering are therefore essential. For instance, for long-read data, several tools can be employed to collapse redundant transcripts and filter artefacts such as TALON or IsoQuant. Similarly, for isoform-level quantification from short-read data, established tools include Salmon, Kallisto-Bustools, and RSEM. The performance of these and other tools can vary depending on the dataset, and we encourage readers to consult comprehensive benchmarking studies, such as Dong et al. for long-read RNA-seq and Westoby et al. for short-read RNA-seq, to select the most appropriate method for their specific needs. For experimental designs with multiple batches, we recommend applying batch correction using established methods (e.g., Harmony, Seurat’s integration workflow) before analysis with <em>ScIsoX</em>. For all data types, starting with a high-quality reference annotation and applying appropriate expression thresholds to filter out extremely low-abundance isoforms is critical. While <em>ScIsoX</em>’s internal filtering of low-expression genes and its focus on highly variable genes help to mitigate the impact of residual noise, the validity of novel isoform analysis ultimately depends on robust upstream quantification.</p>
</div>
<div class="section level3">
<h3 id="id_1-data-preparation">1. Data Preparation<a class="anchor" aria-label="anchor" href="#id_1-data-preparation"></a>
</h3>
<p>ScIsoX works with single-cell gene and transcript expression matrices. Let’s start by setting up the required data formats:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ThaddeusWu.github.io/ScIsoX/">ScIsoX</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Example data is included with the package</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">gene_counts_blood</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">transcript_counts_blood</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">transcript_info</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sample2stage</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the structure of example data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">gene_counts_blood</span><span class="op">)</span>    <span class="co"># Gene-level count matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">transcript_counts_blood</span><span class="op">)</span>  <span class="co"># Transcript-level count matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">transcript_info</span><span class="op">)</span>      <span class="co"># Transcript annotation information</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">sample2stage</span><span class="op">)</span>         <span class="co"># Cell metadata</span></span></code></pre></div>
<div class="section level4">
<h4 id="working-with-your-own-data">Working with Your Own Data<a class="anchor" aria-label="anchor" href="#working-with-your-own-data"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># If working with a GTF file, create transcript information</span></span>
<span><span class="va">transcript_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/create_transcript_info.html">create_transcript_info</a></span><span class="op">(</span></span>
<span>  gtf_path <span class="op">=</span> <span class="st">"path/to/gencode.gtf"</span>,</span>
<span>  remove_version <span class="op">=</span> <span class="cn">TRUE</span>  <span class="co"># Remove version numbers from transcript and gene IDs for better compatibility</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># If starting with isoform counts, generate gene counts</span></span>
<span><span class="va">count_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/generate_gene_counts.html">generate_gene_counts</a></span><span class="op">(</span></span>
<span>  isoform_counts <span class="op">=</span> <span class="va">your_isoform_matrix</span>,</span>
<span>  show_progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extracted output</span></span>
<span><span class="va">gene_counts</span> <span class="op">&lt;-</span> <span class="va">count_results</span><span class="op">$</span><span class="va">gene_counts</span></span>
<span><span class="va">transcript_counts</span> <span class="op">&lt;-</span> <span class="va">your_isoform_matrix</span>  <span class="co"># Original isoform counts</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="data-attribution">Data Attribution<a class="anchor" aria-label="anchor" href="#data-attribution"></a>
</h3>
<p>The example dataset included in ScIsoX is derived from:</p>
<blockquote>
<p>Wang Q, et al. (2022). Single-cell transcriptomic atlas of the human endometrium during the menstrual cycle. <em>Science Advances</em> 8(1):eabg5369. DOI: 10.1126/sciadv.abg5369</p>
</blockquote>
<p>This data is provided under CC BY 4.0 license and has been processed for use as example data in this package.</p>
</div>
<div class="section level3">
<h3 id="id_2-quality-control-analysis">2. Quality Control Analysis<a class="anchor" aria-label="anchor" href="#id_2-quality-control-analysis"></a>
</h3>
<p>Before creating the SCHT object, analyse the distribution of genes per cell to determine appropriate QC parameters:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualise genes per cell distribution using example data</span></span>
<span><span class="va">qc_suggestions</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_genes_per_cell_distribution.html">plot_genes_per_cell_distribution</a></span><span class="op">(</span></span>
<span>  gene_counts <span class="op">=</span> <span class="va">gene_counts_blood</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="st">"density"</span>,  <span class="co"># Options: "density" or "hist"</span></span>
<span>  percentile_cutoffs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,  <span class="co"># Customise percentile lines to show</span></span>
<span>  return_suggestions <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get data-driven QC recommendations with multiple strategies</span></span>
<span><span class="va">qc_recommendations</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/recommend_qc_parameters.html">recommend_qc_parameters</a></span><span class="op">(</span><span class="va">gene_counts_blood</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View recommendations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">qc_recommendations</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="reference/recommend_qc_parameters.html">recommend_qc_parameters()</a></code> function provides three different QC strategies:</p>
<ol style="list-style-type: decimal">
<li><p><strong>MAD_strategy</strong>: A conservative approach using median ± 3 MAD (Median Absolute Deviation). This reduces the risk of including poor quality cells while remaining robust to outliers.</p></li>
<li><p><strong>Interval_90</strong>: A balanced approach using 5th and 95th percentiles. This strategy balances stringency with dataset preservation.</p></li>
<li><p><strong>Interval_80</strong>: An aggressive approach using 10th and 90th percentiles. This provides more stringent filtering for higher quality cell selection.</p></li>
</ol>
<p>You can choose the strategy that best suits your dataset or use your own expertise to set custom thresholds.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select a QC strategy</span></span>
<span><span class="va">selected_strategy</span> <span class="op">&lt;-</span> <span class="va">qc_recommendations</span><span class="op">$</span><span class="va">MAD_strategy</span>  <span class="co"># Conservative approach</span></span>
<span></span>
<span><span class="co"># Or use custom parameters based on experience</span></span>
<span><span class="va">custom_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  min_genes_per_cell <span class="op">=</span> <span class="fl">300</span>,  <span class="co"># Based on prior knowledge of your dataset</span></span>
<span>  max_genes_per_cell <span class="op">=</span> <span class="fl">5000</span>, <span class="co"># Based on prior knowledge of your dataset</span></span>
<span>  min_cells_expressing <span class="op">=</span> <span class="fl">0.02</span>,</span>
<span>  min_expr <span class="op">=</span> <span class="fl">1e-4</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_3-create-scht-object">3. Create SCHT Object<a class="anchor" aria-label="anchor" href="#id_3-create-scht-object"></a>
</h3>
<p>Use the QC parameters to create the Single-Cell Hierarchical Tensor object:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using the example data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">gene_counts_blood</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">transcript_counts_blood</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">transcript_info</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sample2stage</span><span class="op">)</span>  <span class="co"># This contains cell type information</span></span>
<span></span>
<span><span class="co"># Create SCHT object using recommended parameters</span></span>
<span><span class="va">scht_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/create_scht.html">create_scht</a></span><span class="op">(</span></span>
<span>  gene_counts <span class="op">=</span> <span class="va">gene_counts_blood</span>,</span>
<span>  transcript_counts <span class="op">=</span> <span class="va">transcript_counts_blood</span>,</span>
<span>  transcript_info <span class="op">=</span> <span class="va">transcript_info</span>,</span>
<span>  cell_info <span class="op">=</span> <span class="va">sample2stage</span>,</span>
<span>  n_hvg <span class="op">=</span> <span class="fl">3000</span>,</span>
<span>  qc_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    min_genes_per_cell <span class="op">=</span> <span class="fl">4000</span>,       </span>
<span>    max_genes_per_cell <span class="op">=</span> <span class="fl">10000</span>,      </span>
<span>    min_cells_expressing <span class="op">=</span> <span class="fl">0.02</span>,   </span>
<span>    min_expr <span class="op">=</span> <span class="fl">1e-6</span></span>
<span>  <span class="op">)</span>,</span>
<span>  require_cell_type <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sparsity_threshold <span class="op">=</span> <span class="fl">0.4</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine the SCHT object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">scht_obj</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">scht_obj</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_4-calculate-complexity-metrics">4. Calculate Complexity Metrics<a class="anchor" aria-label="anchor" href="#id_4-calculate-complexity-metrics"></a>
</h3>
<p>Calculate the seven core complexity metrics with flexibility in threshold determination:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Option 1: Calculate transcriptomic complexity metrics with data-driven thresholds</span></span>
<span><span class="va">tc_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/calculate_isoform_complexity_metrics.html">calculate_isoform_complexity_metrics</a></span><span class="op">(</span></span>
<span>  scht_obj <span class="op">=</span> <span class="va">scht_obj</span>,</span>
<span>  data_driven_thresholds <span class="op">=</span> <span class="cn">TRUE</span>,  <span class="co"># Automatically determine optimal thresholds from the data</span></span>
<span>  visualise <span class="op">=</span> <span class="cn">TRUE</span>,  <span class="co"># Generate threshold determination visualisations</span></span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Option 2: Calculate with custom thresholds based on prior knowledge</span></span>
<span><span class="va">custom_thresholds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  intra_cellular_isoform_diversity <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  inter_cellular_isoform_diversity <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  intra_cell_type_heterogeneity <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  inter_cell_type_specificity <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  intra_cell_type_heterogeneity_variability <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  inter_cell_type_difference_variability <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  cell_type_coexpression_variability <span class="op">=</span> <span class="fl">0.4</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">tc_results_custom</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/calculate_isoform_complexity_metrics.html">calculate_isoform_complexity_metrics</a></span><span class="op">(</span></span>
<span>  scht_obj <span class="op">=</span> <span class="va">scht_obj</span>,</span>
<span>  default_thresholds <span class="op">=</span> <span class="va">custom_thresholds</span>,</span>
<span>  data_driven_thresholds <span class="op">=</span> <span class="cn">FALSE</span>,  <span class="co"># Use provided thresholds instead of data-driven ones</span></span>
<span>  visualise <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View summary of complexity metrics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tc_results</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Access complexity metrics data frame</span></span>
<span><span class="va">complexity_df</span> <span class="op">&lt;-</span> <span class="va">tc_results</span><span class="op">$</span><span class="va">metrics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">complexity_df</span><span class="op">)</span></span></code></pre></div>
<p>The function supports both data-driven threshold determination, which automatically calculates optimal thresholds based on your dataset’s distribution, and user-defined thresholds based on prior knowledge or specific research requirements. Data-driven thresholds are particularly useful for exploratory analysis, while custom thresholds may be preferred for comparative studies or when specific biological knowledge guides threshold selection.</p>
</div>
<div class="section level3">
<h3 id="id_5-basic-visualisation">5. Basic Visualisation<a class="anchor" aria-label="anchor" href="#id_5-basic-visualisation"></a>
</h3>
<p>Create standard visualisations for exploring transcriptomic complexity:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create complexity landscape plot with default settings</span></span>
<span><span class="va">landscape_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_tc_landscape.html">plot_tc_landscape</a></span><span class="op">(</span></span>
<span>  tc_results <span class="op">=</span> <span class="va">tc_results</span>,</span>
<span>  x_metric <span class="op">=</span> <span class="st">"inter_cellular_isoform_diversity"</span>,</span>
<span>  y_metric <span class="op">=</span> <span class="st">"inter_cell_type_specificity"</span>,</span>
<span>  highlight_genes <span class="op">=</span> <span class="cn">NULL</span>,  <span class="co"># Optionally specify genes to highlight</span></span>
<span>  label_annotation <span class="op">=</span> <span class="st">"intra_cell_type_heterogeneity"</span>,  <span class="co"># Metric used for colour intensity</span></span>
<span>  n_label <span class="op">=</span> <span class="fl">10</span>,  <span class="co"># Number of genes to label</span></span>
<span>  label_direction <span class="op">=</span> <span class="st">"top"</span>,  <span class="co"># "top" or "bottom"</span></span>
<span>  use_thresholds <span class="op">=</span> <span class="cn">TRUE</span>,  <span class="co"># Use thresholds from tc_results</span></span>
<span>  point_transparency <span class="op">=</span> <span class="fl">0.85</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">landscape_plot</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create density plot for complexity landscape</span></span>
<span><span class="va">density_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_tc_density.html">plot_tc_density</a></span><span class="op">(</span></span>
<span>  tc_results <span class="op">=</span> <span class="va">tc_results</span>,</span>
<span>  x_metric <span class="op">=</span> <span class="st">"inter_cellular_isoform_diversity"</span>,</span>
<span>  y_metric <span class="op">=</span> <span class="st">"inter_cell_type_specificity"</span>,</span>
<span>  use_thresholds <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">density_plot</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualise diversity comparison</span></span>
<span><span class="va">diversity_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_diversity_comparison.html">plot_diversity_comparison</a></span><span class="op">(</span></span>
<span>  tc_results <span class="op">=</span> <span class="va">tc_results</span>,</span>
<span>  label_top <span class="op">=</span> <span class="fl">10</span>,  <span class="co"># Label top genes below the diagonal</span></span>
<span>  use_thresholds <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">diversity_plot</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="advanced-usage">Advanced Usage<a class="anchor" aria-label="anchor" href="#advanced-usage"></a>
</h2>
<div class="section level3">
<h3 id="exploring-genes-with-specific-complexity-patterns">Exploring Genes with Specific Complexity Patterns<a class="anchor" aria-label="anchor" href="#exploring-genes-with-specific-complexity-patterns"></a>
</h3>
<p>Identify genes with interesting complexity patterns:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find genes with high intra-cellular diversity and cell type specificity</span></span>
<span><span class="va">complex_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/find_complexity_pattern.html">find_complexity_pattern</a></span><span class="op">(</span></span>
<span>  <span class="va">tc_results</span><span class="op">$</span><span class="va">metrics</span>,</span>
<span>  pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    intra_cellular_isoform_diversity_class <span class="op">=</span> <span class="st">"Strong Isoform Co-expression"</span>,</span>
<span>    inter_cell_type_specificity_class <span class="op">=</span> <span class="st">"Cell-Type-Specific Isoform Expression"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  top_n <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  sort_by <span class="op">=</span> <span class="st">"inter_cell_type_specificity"</span>  <span class="co"># Sort by this metric</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Select genes with high cellular heterogeneity</span></span>
<span><span class="va">heterogeneous_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/select_genes_of_interest.html">select_genes_of_interest</a></span><span class="op">(</span></span>
<span>  <span class="va">tc_results</span><span class="op">$</span><span class="va">metrics</span>,</span>
<span>  category <span class="op">=</span> <span class="st">"High Cellular Heterogeneity"</span>,</span>
<span>  column <span class="op">=</span> <span class="st">"intra_cell_type_heterogeneity_class"</span>,</span>
<span>  top_n <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  sort_by <span class="op">=</span> <span class="st">"intra_cell_type_heterogeneity"</span>  <span class="co"># Sort by most heterogeneous</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare metrics for selected genes</span></span>
<span><span class="va">gene_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/compare_gene_metrics.html">compare_gene_metrics</a></span><span class="op">(</span></span>
<span>  tc_metrics <span class="op">=</span> <span class="va">tc_results</span>,</span>
<span>  gene_names <span class="op">=</span> <span class="va">heterogeneous_genes</span>,</span>
<span>  include_mean <span class="op">=</span> <span class="cn">TRUE</span>  <span class="co"># Include mean values for easier comparison</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="reference/find_complexity_pattern.html">find_complexity_pattern()</a></code> function enables you to identify genes matching specific combinations of complexity classifications across multiple dimensions. You can specify as many criteria as needed and sort the results by your metric of interest.</p>
<p>The <code><a href="reference/select_genes_of_interest.html">select_genes_of_interest()</a></code> function provides a simpler interface for filtering genes based on a single classification dimension, useful for quickly isolating genes with specific characteristics.</p>
</div>
<div class="section level3">
<h3 id="multi-dimensional-complexity-visualisation">Multi-dimensional Complexity Visualisation<a class="anchor" aria-label="anchor" href="#multi-dimensional-complexity-visualisation"></a>
</h3>
<p>Create advanced visualisations for multi-dimensional complexity analysis:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create dual diversity comparison plot</span></span>
<span><span class="va">diversity_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_diversity_comparison.html">plot_diversity_comparison</a></span><span class="op">(</span></span>
<span>  tc_results <span class="op">=</span> <span class="va">tc_results</span>,</span>
<span>  label_top <span class="op">=</span> <span class="fl">15</span>,  <span class="co"># Number of genes to label</span></span>
<span>  point_transparency <span class="op">=</span> <span class="fl">0.85</span>,</span>
<span>  use_thresholds <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create radar chart for selected genes</span></span>
<span><span class="va">radar_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_complexity_radar.html">plot_complexity_radar</a></span><span class="op">(</span></span>
<span>  tc_metrics <span class="op">=</span> <span class="va">tc_results</span>,</span>
<span>  genes <span class="op">=</span> <span class="va">complex_genes</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,  <span class="co"># Compare up to 5 genes</span></span>
<span>  scale_type <span class="op">=</span> <span class="st">"per_metric"</span>  <span class="co"># Options: "global", "per_metric", or "none"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create ridge plots for visualising complexity distributions</span></span>
<span><span class="va">ridge_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_complexity_ridges.html">plot_complexity_ridges</a></span><span class="op">(</span></span>
<span>  tc_results <span class="op">=</span> <span class="va">tc_results</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"global"</span>,  <span class="co"># Options: "global" or "cell_type"</span></span>
<span>  metrics <span class="op">=</span> <span class="cn">NULL</span>,  <span class="co"># NULL will use all metrics, or specify a subset</span></span>
<span>  scale_values <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create cell type-specific ridge plots</span></span>
<span><span class="va">ct_ridges</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_complexity_ridges.html">plot_complexity_ridges</a></span><span class="op">(</span></span>
<span>  tc_results <span class="op">=</span> <span class="va">tc_results</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"cell_type"</span>,</span>
<span>  n_celltypes <span class="op">=</span> <span class="fl">5</span>,  <span class="co"># Maximum number of cell types to show</span></span>
<span>  label_y_axis <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create radar charts for a single gene across cell types</span></span>
<span><span class="va">single_gene_radar</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_single_gene_radar_cell_type.html">plot_single_gene_radar_cell_type</a></span><span class="op">(</span></span>
<span>  tc_results <span class="op">=</span> <span class="va">tc_results</span>,</span>
<span>  gene_name <span class="op">=</span> <span class="va">complex_genes</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  metrics <span class="op">=</span> <span class="cn">NULL</span>,  <span class="co"># NULL will use default metrics, or specify custom metrics</span></span>
<span>  scale_values <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare multiple genes across cell types with radar charts</span></span>
<span><span class="va">multi_gene_radar</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_compare_multiple_genes_radar_cell_type.html">plot_compare_multiple_genes_radar_cell_type</a></span><span class="op">(</span></span>
<span>  tc_results <span class="op">=</span> <span class="va">tc_results</span>,</span>
<span>  gene_names <span class="op">=</span> <span class="va">complex_genes</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>  cell_types <span class="op">=</span> <span class="cn">NULL</span>,  <span class="co"># NULL will auto-detect, or specify cell types</span></span>
<span>  metrics <span class="op">=</span> <span class="cn">NULL</span>,  <span class="co"># NULL will use default metrics</span></span>
<span>  scale_type <span class="op">=</span> <span class="st">"per_cell_type"</span>,  <span class="co"># Options: "global" or "per_cell_type"</span></span>
<span>  ncol <span class="op">=</span> <span class="fl">3</span>  <span class="co"># Number of columns in the grid layout</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>These visualisations provide different perspectives on gene complexity. The radar charts are particularly useful for comparing multiple metrics simultaneously, while ridge plots reveal the distribution of each metric across your dataset or cell types.</p>
</div>
<div class="section level3">
<h3 id="isoform-usage-analysis">Isoform Usage Analysis<a class="anchor" aria-label="anchor" href="#isoform-usage-analysis"></a>
</h3>
<p>Analyse isoform usage patterns for genes of interest:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find a gene with multiple isoforms for demonstration</span></span>
<span><span class="va">multi_iso_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">transcript_info</span><span class="op">$</span><span class="va">gene_name</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">multi_iso_genes</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">example_gene</span> <span class="op">&lt;-</span> <span class="va">multi_iso_genes</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Create heatmap for isoform co-expression</span></span>
<span>  <span class="va">coexp_heatmap</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_isoform_coexpression.html">plot_isoform_coexpression</a></span><span class="op">(</span></span>
<span>    scht_obj <span class="op">=</span> <span class="va">scht_obj</span>,</span>
<span>    gene <span class="op">=</span> <span class="va">example_gene</span>,</span>
<span>    display_numbers <span class="op">=</span> <span class="cn">TRUE</span>  <span class="co"># Show correlation values in cells</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Create stacked bar chart for isoform usage across cell types</span></span>
<span>  <span class="va">isoform_profile</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_isoform_profile.html">plot_isoform_profile</a></span><span class="op">(</span></span>
<span>    scht_obj <span class="op">=</span> <span class="va">scht_obj</span>,</span>
<span>    gene <span class="op">=</span> <span class="va">example_gene</span>,</span>
<span>    cell_type_order <span class="op">=</span> <span class="cn">NULL</span>,  <span class="co"># Optional ordering of cell types</span></span>
<span>    min_prop <span class="op">=</span> <span class="fl">0.05</span>,  <span class="co"># Minimum proportion to display</span></span>
<span>    color_palette <span class="op">=</span> <span class="cn">NULL</span>  <span class="co"># Optional custom colour palette</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Create line plot for isoform transitions across cell types</span></span>
<span>  <span class="co"># Get actual cell types from the data</span></span>
<span>  <span class="va">cell_types</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">scht_obj</span><span class="op">$</span><span class="va">cell_info</span><span class="op">$</span><span class="va">cell_type</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cell_types</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">transition_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_isoform_transitions.html">plot_isoform_transitions</a></span><span class="op">(</span></span>
<span>      scht_obj <span class="op">=</span> <span class="va">scht_obj</span>,</span>
<span>      gene <span class="op">=</span> <span class="va">example_gene</span>,</span>
<span>      cell_type_order <span class="op">=</span> <span class="va">cell_types</span>,  <span class="co"># Use actual cell types</span></span>
<span>      min_prop <span class="op">=</span> <span class="fl">0.05</span>,  <span class="co"># Minimum proportion to display</span></span>
<span>      smooth <span class="op">=</span> <span class="cn">TRUE</span>,  <span class="co"># Apply smoothing to lines</span></span>
<span>      color_palette <span class="op">=</span> <span class="cn">NULL</span>  <span class="co"># Optional custom colour palette</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>These functions help you understand isoform usage dynamics:</p>
<ul>
<li>
<code><a href="reference/plot_isoform_coexpression.html">plot_isoform_coexpression()</a></code> reveals correlations between isoforms, indicating coordinated or mutually exclusive expression</li>
<li>
<code><a href="reference/plot_isoform_profile.html">plot_isoform_profile()</a></code> shows the relative abundance of each isoform across cell types</li>
<li>
<code><a href="reference/plot_isoform_transitions.html">plot_isoform_transitions()</a></code> is particularly useful for developmental trajectories or other ordered progressions, showing how isoform usage changes across stages</li>
</ul>
</div>
<div class="section level3">
<h3 id="comparing-complexity-across-conditions">Comparing Complexity Across Conditions<a class="anchor" aria-label="anchor" href="#comparing-complexity-across-conditions"></a>
</h3>
<p>For experiments comparing different conditions:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For demonstration, we'll simulate different conditions by subsetting our data</span></span>
<span><span class="co"># In practice, you would have separate datasets for each condition</span></span>
<span></span>
<span><span class="co"># Create subsets to simulate conditions (e.g., different developmental stages)</span></span>
<span><span class="va">stages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sample2stage</span><span class="op">$</span><span class="va">cell_type</span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">stages</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Create SCHT objects for different stages/conditions</span></span>
<span>  <span class="va">stage1_cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">sample2stage</span><span class="op">)</span><span class="op">[</span><span class="va">sample2stage</span><span class="op">$</span><span class="va">cell_type</span> <span class="op">==</span> <span class="va">stages</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">stage2_cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">sample2stage</span><span class="op">)</span><span class="op">[</span><span class="va">sample2stage</span><span class="op">$</span><span class="va">cell_type</span> <span class="op">==</span> <span class="va">stages</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Create subset SCHT objects (in practice, these would be your different conditions)</span></span>
<span>  <span class="co"># Note: This is for demonstration only</span></span>
<span>  <span class="va">scht_stage1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/create_scht.html">create_scht</a></span><span class="op">(</span></span>
<span>    gene_counts <span class="op">=</span> <span class="va">gene_counts_blood</span><span class="op">[</span>, <span class="va">stage1_cells</span><span class="op">]</span>,</span>
<span>    transcript_counts <span class="op">=</span> <span class="va">transcript_counts_blood</span><span class="op">[</span>, <span class="va">stage1_cells</span><span class="op">]</span>,</span>
<span>    transcript_info <span class="op">=</span> <span class="va">transcript_info</span>,</span>
<span>    cell_info <span class="op">=</span> <span class="va">sample2stage</span><span class="op">[</span><span class="va">stage1_cells</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>,</span>
<span>    n_hvg <span class="op">=</span> <span class="fl">1000</span>,  <span class="co"># Fewer HVGs for smaller dataset</span></span>
<span>    qc_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      min_genes_per_cell <span class="op">=</span> <span class="fl">2000</span>,  <span class="co"># Adjusted for subset</span></span>
<span>      max_genes_per_cell <span class="op">=</span> <span class="fl">8000</span>,</span>
<span>      min_cells_expressing <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>      min_expr <span class="op">=</span> <span class="fl">1e-6</span></span>
<span>    <span class="op">)</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Calculate complexity metrics</span></span>
<span>  <span class="va">tc_results_stage1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/calculate_isoform_complexity_metrics.html">calculate_isoform_complexity_metrics</a></span><span class="op">(</span><span class="va">scht_stage1</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">tc_results_stage2</span> <span class="op">&lt;-</span> <span class="va">tc_results_stage1</span>  <span class="co"># For demo purposes</span></span>
<span>  </span>
<span>  <span class="co"># Create a list of results</span></span>
<span>  <span class="va">tc_results_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    Stage1 <span class="op">=</span> <span class="va">tc_results_stage1</span>,</span>
<span>    Stage2 <span class="op">=</span> <span class="va">tc_results_stage2</span>  <span class="co"># In practice, calculate separately</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Compare complexity (demonstration with same data)</span></span>
<span>  <span class="co"># In practice, these would show real differences between conditions</span></span>
<span>  <span class="va">diff_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_compare_tc_density_difference.html">plot_compare_tc_density_difference</a></span><span class="op">(</span></span>
<span>    tc_results_list <span class="op">=</span> <span class="va">tc_results_list</span>,</span>
<span>    group_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Stage 1"</span>, <span class="st">"Stage 2"</span><span class="op">)</span>,</span>
<span>    x_metric <span class="op">=</span> <span class="st">"inter_cellular_isoform_diversity"</span>,</span>
<span>    y_metric <span class="op">=</span> <span class="st">"inter_cell_type_specificity"</span>,</span>
<span>    grid_size <span class="op">=</span> <span class="fl">50</span>  <span class="co"># Lower resolution for demo</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>These comparative functions are designed for experimental designs with multiple conditions:</p>
<ul>
<li>
<code><a href="reference/plot_compare_tc_density_difference.html">plot_compare_tc_density_difference()</a></code> highlights regions in the complexity landscape where genes shift between conditions</li>
<li>
<code><a href="reference/plot_compare_tc_complexity_heatmap.html">plot_compare_tc_complexity_heatmap()</a></code> creates heatmaps for visualising multiple complexity metrics and their changes across different groups or conditions.</li>
</ul>
<p>Each function offers different ways to select genes of interest, including variance-based selection (genes with highest variation across conditions), magnitude-based selection (genes with largest absolute changes), or custom selection (specific genes of interest).</p>
</div>
<div class="section level3">
<h3 id="co-expression-analysis">Co-expression Analysis<a class="anchor" aria-label="anchor" href="#co-expression-analysis"></a>
</h3>
<p>ScIsoX provides comprehensive tools for analysing isoform co-expression patterns:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find genes with multiple isoforms for co-expression analysis</span></span>
<span><span class="va">multi_iso_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">transcript_info</span><span class="op">$</span><span class="va">gene_name</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">multi_iso_genes</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Calculate co-expression for a single gene</span></span>
<span>  <span class="va">coexp_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/calculate_isoform_coexpression.html">calculate_isoform_coexpression</a></span><span class="op">(</span></span>
<span>    scht_obj <span class="op">=</span> <span class="va">scht_obj</span>,</span>
<span>    gene <span class="op">=</span> <span class="va">multi_iso_genes</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"pearson"</span>,  <span class="co"># Options: "pearson", "spearman"</span></span>
<span>    min_cells <span class="op">=</span> <span class="fl">10</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Analyse co-expression across all cell types</span></span>
<span>  <span class="va">multi_coexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/calculate_gene_coexpression_all_celltypes.html">calculate_gene_coexpression_all_celltypes</a></span><span class="op">(</span></span>
<span>    scht_obj <span class="op">=</span> <span class="va">scht_obj</span>,</span>
<span>    gene <span class="op">=</span> <span class="va">multi_iso_genes</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"pearson"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Identify conservation patterns</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"multi_coexp"</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">multi_iso_genes</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">conservation_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/analyse_coexpression_conservation.html">analyse_coexpression_conservation</a></span><span class="op">(</span></span>
<span>    integrated_scht <span class="op">=</span> <span class="va">scht_obj</span>,</span>
<span>    gene <span class="op">=</span> <span class="va">multi_iso_genes</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"pearson"</span>,</span>
<span>    min_cells <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    consistency_threshold <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>    correlation_threshold <span class="op">=</span> <span class="fl">0.3</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># View conservation summary</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">conservation_results</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Plot conservation summary</span></span>
<span>  <span class="fu"><a href="reference/plot_conservation_summary.html">plot_conservation_summary</a></span><span class="op">(</span></span>
<span>    <span class="va">conservation_results</span>,</span>
<span>    output_file <span class="op">=</span> <span class="st">"conservation_summary.pdf"</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">8</span>,</span>
<span>    height <span class="op">=</span> <span class="fl">6</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Detect isoform switching (antagonistic relationships)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"coexp_result"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">switching_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/detect_isoform_switching.html">detect_isoform_switching</a></span><span class="op">(</span></span>
<span>    cor_result <span class="op">=</span> <span class="va">coexp_result</span>,</span>
<span>    threshold <span class="op">=</span> <span class="op">-</span><span class="fl">0.3</span>,</span>
<span>    strong_threshold <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># View switching pairs</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">switching_results</span><span class="op">$</span><span class="va">n_switching_pairs</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">switching_results</span><span class="op">$</span><span class="va">switching_pairs</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Calculate co-expression statistics</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"coexp_result"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">coexp_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/calculate_coexpression_stats.html">calculate_coexpression_stats</a></span><span class="op">(</span></span>
<span>    cor_result <span class="op">=</span> <span class="va">coexp_result</span>,</span>
<span>    include_pairwise <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Mean correlation:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">coexp_stats</span><span class="op">$</span><span class="va">mean_correlation</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Positive correlations:"</span>, <span class="va">coexp_stats</span><span class="op">$</span><span class="va">pct_positive</span>, <span class="st">"%"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Export co-expression results</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"multi_coexp"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="reference/export_coexpression_results.html">export_coexpression_results</a></span><span class="op">(</span></span>
<span>    coexpr_result <span class="op">=</span> <span class="va">multi_coexp</span>,</span>
<span>    output_prefix <span class="op">=</span> <span class="st">"coexpression_analysis"</span>,</span>
<span>    formats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"csv"</span>, <span class="st">"rds"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Launch interactive Shiny application</span></span>
<span><span class="fu"><a href="reference/launch_coexpression_app.html">launch_coexpression_app</a></span><span class="op">(</span><span class="va">scht_obj</span><span class="op">)</span></span></code></pre></div>
<p>The co-expression analysis suite provides: - <strong>Correlation analysis</strong>: Calculate pairwise correlations between isoforms - <strong>Conservation patterns</strong>: Identify conserved, variable, and mixed patterns across cell types - <strong>Isoform switching</strong>: Detect antagonistic isoform relationships - <strong>Interactive exploration</strong>: Shiny app with heatmaps, statistics, and export functionality</p>
</div>
<div class="section level3">
<h3 id="performance-analysis--quality-control">Performance Analysis &amp; Quality Control<a class="anchor" aria-label="anchor" href="#performance-analysis--quality-control"></a>
</h3>
<p>Monitor performance and generate comprehensive QC reports:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Analyse SCHT sparsity and memory efficiency</span></span>
<span><span class="va">sparsity_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/calculate_scht_sparsity.html">calculate_scht_sparsity</a></span><span class="op">(</span><span class="va">scht_obj</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sparsity_stats</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare with cell type-specific analysis</span></span>
<span><span class="va">ct_sparsity</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/calculate_ct_scht_sparsity.html">calculate_ct_scht_sparsity</a></span><span class="op">(</span><span class="va">scht_obj</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate comprehensive QC report</span></span>
<span><span class="fu"><a href="reference/generate_qc_report.html">generate_qc_report</a></span><span class="op">(</span></span>
<span>  scht_obj <span class="op">=</span> <span class="va">scht_obj</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"qc_reports"</span>,</span>
<span>  dataset_name <span class="op">=</span> <span class="st">"my_dataset"</span>,</span>
<span>  include_plots <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  include_summary_stats <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Analyse sparsity across different data representations</span></span>
<span><span class="va">sparsity_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/analyse_sparsity_for_table.html">analyse_sparsity_for_table</a></span><span class="op">(</span></span>
<span>  gene_counts <span class="op">=</span> <span class="va">gene_counts_blood</span>,</span>
<span>  transcript_counts <span class="op">=</span> <span class="va">transcript_counts_blood</span>,</span>
<span>  transcript_info <span class="op">=</span> <span class="va">transcript_info</span>,</span>
<span>  scht_obj <span class="op">=</span> <span class="va">scht_obj</span>,</span>
<span>  dataset_name <span class="op">=</span> <span class="st">"Blood Cell Example Data"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>These functions help you: - <strong>Understand memory usage</strong>: See how SCHT’s hierarchical structure saves memory - <strong>Monitor performance</strong>: Track processing time and memory utilisation - <strong>Quality control</strong>: Generate detailed reports on data quality and filtering results - <strong>Compare efficiency</strong>: Demonstrate advantages over naive tensor approaches</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="visualisation-gallery">Visualisation Gallery<a class="anchor" aria-label="anchor" href="#visualisation-gallery"></a>
</h2>
<p>ScIsoX provides over 13 specialised visualisation functions for comprehensive exploration of transcriptomic complexity. Here are detailed examples:</p>
<div class="section level3">
<h3 id="threshold-visualisations">Threshold Visualisations<a class="anchor" aria-label="anchor" href="#threshold-visualisations"></a>
</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View threshold determination plots from complexity calculation</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="va">tc_results</span><span class="op">$</span><span class="va">visualise</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="reference/plot_threshold_visualisations.html">plot_threshold_visualisations</a></span><span class="op">(</span></span>
<span>    threshold_plots <span class="op">=</span> <span class="va">tc_results</span><span class="op">$</span><span class="va">threshold_plots</span>,</span>
<span>    ncol <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Threshold Determination for Complexity Metrics"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="complexity-landscape-plots">Complexity Landscape Plots<a class="anchor" aria-label="anchor" href="#complexity-landscape-plots"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create landscape plot with marginal distributions</span></span>
<span><span class="va">landscape</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_tc_landscape.html">plot_tc_landscape</a></span><span class="op">(</span></span>
<span>  tc_results <span class="op">=</span> <span class="va">tc_results</span>,</span>
<span>  x_metric <span class="op">=</span> <span class="st">"inter_cellular_isoform_diversity"</span>,</span>
<span>  y_metric <span class="op">=</span> <span class="st">"inter_cell_type_specificity"</span>,</span>
<span>  highlight_genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">tc_results</span><span class="op">$</span><span class="va">metrics</span><span class="op">$</span><span class="va">inter_cellular_isoform_diversity</span>, </span>
<span>                              decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>  label_annotation <span class="op">=</span> <span class="st">"intra_cell_type_heterogeneity"</span>,</span>
<span>  n_label <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  label_direction <span class="op">=</span> <span class="st">"top"</span>,  <span class="co"># "top" or "bottom"</span></span>
<span>  use_thresholds <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  x_threshold <span class="op">=</span> <span class="cn">NULL</span>,  <span class="co"># Use threshold from tc_results</span></span>
<span>  y_threshold <span class="op">=</span> <span class="cn">NULL</span>,  <span class="co"># Use threshold from tc_results</span></span>
<span>  point_transparency <span class="op">=</span> <span class="fl">0.85</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create density contour plot</span></span>
<span><span class="va">density</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_tc_density.html">plot_tc_density</a></span><span class="op">(</span></span>
<span>  tc_results <span class="op">=</span> <span class="va">tc_results</span>,</span>
<span>  x_metric <span class="op">=</span> <span class="st">"inter_cellular_isoform_diversity"</span>,</span>
<span>  y_metric <span class="op">=</span> <span class="st">"inter_cell_type_specificity"</span>,</span>
<span>  use_thresholds <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  x_threshold <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  y_threshold <span class="op">=</span> <span class="fl">0.6</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="diversity-analysis-plots">Diversity Analysis Plots<a class="anchor" aria-label="anchor" href="#diversity-analysis-plots"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare intra- vs inter-cellular diversity</span></span>
<span><span class="va">diversity_comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_diversity_comparison.html">plot_diversity_comparison</a></span><span class="op">(</span></span>
<span>  tc_results <span class="op">=</span> <span class="va">tc_results</span>,</span>
<span>  label_top <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  point_transparency <span class="op">=</span> <span class="fl">0.85</span>,</span>
<span>  use_thresholds <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  x_threshold <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  y_threshold <span class="op">=</span> <span class="fl">0.6</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create ridge plots for metric distributions</span></span>
<span><span class="va">ridge_global</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_complexity_ridges.html">plot_complexity_ridges</a></span><span class="op">(</span></span>
<span>  tc_results <span class="op">=</span> <span class="va">tc_results</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"global"</span>,</span>
<span>  metrics <span class="op">=</span> <span class="cn">NULL</span>,  <span class="co"># Use all metrics</span></span>
<span>  scale_values <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Cell type-specific ridge plots</span></span>
<span><span class="va">ridge_ct</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_complexity_ridges.html">plot_complexity_ridges</a></span><span class="op">(</span></span>
<span>  tc_results <span class="op">=</span> <span class="va">tc_results</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"cell_type"</span>,</span>
<span>  cell_types <span class="op">=</span> <span class="cn">NULL</span>,  <span class="co"># Auto-detect</span></span>
<span>  metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"intra_cellular_isoform_diversity"</span>, </span>
<span>              <span class="st">"inter_cellular_isoform_diversity"</span><span class="op">)</span>,</span>
<span>  n_celltypes <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  label_y_axis <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="isoform-co-expression-visualisations">Isoform Co-expression Visualisations<a class="anchor" aria-label="anchor" href="#isoform-co-expression-visualisations"></a>
</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find genes with multiple isoforms</span></span>
<span><span class="va">multi_iso_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">transcript_info</span><span class="op">$</span><span class="va">gene_name</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">multi_iso_genes</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Co-expression heatmap</span></span>
<span>  <span class="va">coexp_heatmap</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_isoform_coexpression.html">plot_isoform_coexpression</a></span><span class="op">(</span></span>
<span>    scht_obj <span class="op">=</span> <span class="va">scht_obj</span>,</span>
<span>    gene <span class="op">=</span> <span class="va">multi_iso_genes</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"pearson"</span>,</span>
<span>    display_numbers <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    cluster_columns <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    title <span class="op">=</span> <span class="cn">NULL</span>  <span class="co"># Auto-generated</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Isoform usage profile across cell types</span></span>
<span>  <span class="va">usage_profile</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_isoform_profile.html">plot_isoform_profile</a></span><span class="op">(</span></span>
<span>    scht_obj <span class="op">=</span> <span class="va">scht_obj</span>,</span>
<span>    gene <span class="op">=</span> <span class="va">multi_iso_genes</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    cell_type_order <span class="op">=</span> <span class="cn">NULL</span>,  <span class="co"># Auto-order</span></span>
<span>    min_prop <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>    colour_palette <span class="op">=</span> <span class="cn">NULL</span>  <span class="co"># Default palette</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Isoform transitions (if ordered cell types)</span></span>
<span>  <span class="va">cell_types</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">scht_obj</span><span class="op">$</span><span class="va">cell_info</span><span class="op">$</span><span class="va">cell_type</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cell_types</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">transitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_isoform_transitions.html">plot_isoform_transitions</a></span><span class="op">(</span></span>
<span>      scht_obj <span class="op">=</span> <span class="va">scht_obj</span>,</span>
<span>      gene <span class="op">=</span> <span class="va">multi_iso_genes</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>      cell_type_order <span class="op">=</span> <span class="va">cell_types</span>,</span>
<span>      selected_isoforms <span class="op">=</span> <span class="cn">NULL</span>,  <span class="co"># All isoforms</span></span>
<span>      min_prop <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>      smooth <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      colour_palette <span class="op">=</span> <span class="cn">NULL</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="radar-charts-for-multi-dimensional-comparison">Radar Charts for Multi-dimensional Comparison<a class="anchor" aria-label="anchor" href="#radar-charts-for-multi-dimensional-comparison"></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare top complex genes</span></span>
<span><span class="va">complex_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">tc_results</span><span class="op">$</span><span class="va">metrics</span><span class="op">$</span><span class="va">inter_cellular_isoform_diversity</span>, </span>
<span>                           decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Multi-gene radar chart</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ggradar"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">radar_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_complexity_radar.html">plot_complexity_radar</a></span><span class="op">(</span></span>
<span>    tc_metrics <span class="op">=</span> <span class="va">tc_results</span>,</span>
<span>    genes <span class="op">=</span> <span class="va">complex_genes</span>,</span>
<span>    scale_type <span class="op">=</span> <span class="st">"global"</span>  <span class="co"># "global", "per_metric", or "none"</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Single gene across cell types</span></span>
<span>  <span class="va">radar_single</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_single_gene_radar_cell_type.html">plot_single_gene_radar_cell_type</a></span><span class="op">(</span></span>
<span>    tc_results <span class="op">=</span> <span class="va">tc_results</span>,</span>
<span>    gene_name <span class="op">=</span> <span class="va">complex_genes</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    metrics <span class="op">=</span> <span class="cn">NULL</span>,  <span class="co"># Default metrics</span></span>
<span>    scale_values <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Multiple genes across cell types</span></span>
<span>  <span class="va">radar_compare</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_compare_multiple_genes_radar_cell_type.html">plot_compare_multiple_genes_radar_cell_type</a></span><span class="op">(</span></span>
<span>    tc_results <span class="op">=</span> <span class="va">tc_results</span>,</span>
<span>    gene_names <span class="op">=</span> <span class="va">complex_genes</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>    cell_types <span class="op">=</span> <span class="cn">NULL</span>,  <span class="co"># All cell types</span></span>
<span>    metrics <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    scale_type <span class="op">=</span> <span class="st">"per_cell_type"</span>,</span>
<span>    ncol <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="comparative-analysis-visualisations">Comparative Analysis Visualisations<a class="anchor" aria-label="anchor" href="#comparative-analysis-visualisations"></a>
</h3>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For comparing conditions (requires multiple tc_results)</span></span>
<span><span class="co"># Example with simulated conditions</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sample2stage</span><span class="op">$</span><span class="va">cell_type</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Create comparison list (in practice, use different conditions)</span></span>
<span>  <span class="va">tc_results_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    Baseline <span class="op">=</span> <span class="va">tc_results</span>,</span>
<span>    Treatment <span class="op">=</span> <span class="va">tc_results</span>  <span class="co"># Would be different condition</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Density difference plots</span></span>
<span>  <span class="va">density_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_compare_tc_density_difference.html">plot_compare_tc_density_difference</a></span><span class="op">(</span></span>
<span>    tc_results_list <span class="op">=</span> <span class="va">tc_results_list</span>,</span>
<span>    group_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Baseline"</span>, <span class="st">"Treatment"</span><span class="op">)</span>,</span>
<span>    pair_indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    x_metric <span class="op">=</span> <span class="st">"inter_cellular_isoform_diversity"</span>,</span>
<span>    y_metric <span class="op">=</span> <span class="st">"inter_cell_type_specificity"</span>,</span>
<span>    grid_size <span class="op">=</span> <span class="fl">50</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Complexity heatmaps</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ComplexHeatmap"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">heatmap_comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_compare_tc_complexity_heatmap.html">plot_compare_tc_complexity_heatmap</a></span><span class="op">(</span></span>
<span>      tc_results_list <span class="op">=</span> <span class="va">tc_results_list</span>,</span>
<span>      groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Baseline"</span>, <span class="st">"Treatment"</span><span class="op">)</span>,</span>
<span>      metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"intra_cellular_isoform_diversity"</span>, </span>
<span>                  <span class="st">"inter_cellular_isoform_diversity"</span><span class="op">)</span>,</span>
<span>      n_top_genes <span class="op">=</span> <span class="fl">30</span>,</span>
<span>      selection_method <span class="op">=</span> <span class="st">"variance"</span>,</span>
<span>      cluster_genes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      show_changes <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Display specific metric heatmap</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">heatmap_comp</span><span class="op">$</span><span class="va">heatmaps</span><span class="op">$</span><span class="va">intra_cellular_isoform_diversity</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="co-expression-pattern-visualisations">Co-expression Pattern Visualisations<a class="anchor" aria-label="anchor" href="#co-expression-pattern-visualisations"></a>
</h3>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot co-expression across cell types</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"multi_coexp"</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">multi_coexp</span><span class="op">$</span><span class="va">cell_types</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">coexp_pattern</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_coexpression_across_celltypes.html">plot_coexpression_across_celltypes</a></span><span class="op">(</span></span>
<span>    coexpr_all_result <span class="op">=</span> <span class="va">multi_coexp</span>,</span>
<span>    pair_selection <span class="op">=</span> <span class="st">"all"</span>,  <span class="co"># "all", "switching", "conserved"</span></span>
<span>    threshold <span class="op">=</span> <span class="fl">0.3</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">coexp_pattern</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Cell type similarity based on co-expression</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"multi_coexp"</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">multi_coexp</span><span class="op">$</span><span class="va">cell_types</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Extract correlation matrices</span></span>
<span>  <span class="va">cor_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">multi_coexp</span><span class="op">$</span><span class="va">cell_types</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">cor_matrix</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Calculate similarity</span></span>
<span>  <span class="va">ct_similarity</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/calculate_celltype_coexpression_similarity.html">calculate_celltype_coexpression_similarity</a></span><span class="op">(</span></span>
<span>    correlation_list <span class="op">=</span> <span class="va">cor_list</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"correlation"</span>  <span class="co"># "correlation", "euclidean", "manhattan"</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Visualise with hierarchical clustering</span></span>
<span>  <span class="va">hc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="va">ct_similarity</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hc</span>, main <span class="op">=</span> <span class="st">"Cell Type Similarity Based on Co-expression Patterns"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="export-visualisations">Export Visualisations<a class="anchor" aria-label="anchor" href="#export-visualisations"></a>
</h3>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Save plots to PDF</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span><span class="st">"scisox_visualisations.pdf"</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add your plots here</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">landscape</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">diversity_comp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ridge_global</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save individual plots</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"complexity_landscape.pdf"</span>, <span class="va">landscape</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"diversity_comparison.pdf"</span>, <span class="va">diversity_comp</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="troubleshooting">Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting"></a>
</h2>
<div class="section level3">
<h3 id="common-issues-and-solutions">Common Issues and Solutions<a class="anchor" aria-label="anchor" href="#common-issues-and-solutions"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<p><strong>Memory Issues with Large Datasets</strong></p>
<p><strong>Problem</strong>: R crashes or shows high memory usage when creating SCHT objects from large datasets.</p>
<p><strong>Solution</strong>:</p>
<ul>
<li>Set <code>sparsity_threshold</code> to a lower value (e.g., 0.2) to force sparse matrix usage</li>
<li>Process data in batches using smaller values</li>
<li>For very large datasets, pre-filter genes with low expression before creating the SCHT object</li>
</ul>
</li>
<li>
<p><strong>Missing Cell Type Information</strong></p>
<p><strong>Problem</strong>: Error about missing cell types when calculating complexity metrics.</p>
<p><strong>Solution</strong>:</p>
<ul>
<li>Ensure <code>cell_info</code> data frame contains a column named “cell_type”</li>
<li>Make sure cell IDs in <code>cell_info</code> match column names in count matrices</li>
<li>Set <code>require_cell_type = FALSE</code> if cell type information is not available</li>
<li>Check if cell type names contain special characters or spaces that might cause issues</li>
</ul>
</li>
<li>
<p><strong>Missing Dependencies for Visualisations</strong></p>
<p><strong>Problem</strong>: Errors when trying to create visualisations.</p>
<p><strong>Solution</strong>:</p>
<ul>
<li>Install all suggested packages for full visualisation support</li>
<li>Check for specific missing packages mentioned in error messages</li>
<li>For radar charts, ensure <code>ggradar</code> is installed from GitHub</li>
<li>Use <code><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace("package_name", quietly = TRUE)</a></code> to check if needed packages are installed</li>
</ul>
</li>
<li>
<p><strong>Performance Optimisation</strong></p>
<p><strong>Problem</strong>: Processing is slow for large datasets.</p>
<p><strong>Solution</strong>:</p>
<ul>
<li>Use smaller <code>n_hvg</code> values (e.g., 1000-2000)</li>
<li>Increase <code>min_cells_expressing</code> threshold to focus on well-expressed genes</li>
<li>Process cell types separately if working with many cell types</li>
<li>Consider pre-filtering the dataset to include only genes of interest</li>
</ul>
</li>
</ol>
</div>
<div class="section level3">
<h3 id="getting-help">Getting Help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h3>
<p>If you encounter problems not addressed here, please:</p>
<ol style="list-style-type: decimal">
<li>Submit issues via the GitHub repository</li>
<li>Contact the package maintainers with detailed information about your issue, including:
<ul>
<li>R session information (<code><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo()</a></code>)</li>
<li>Error messages (full traceback if possible)</li>
<li>A minimal reproducible example if possible</li>
</ul>
</li>
</ol>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use ScIsoX in your research, please cite:</p>
<p><strong>Manuscript:</strong></p>
<pre><code>ScIsoX: A Multidimensional Framework for Measuring Isoform-Level Transcriptomic Complexity in Single Cells
Wu, S and Schmitz, U
bioRxiv, 2025
DOI: 10.1101/2025.04.28.650897
url: https://www.biorxiv.org/content/10.1101/2025.04.28.650897v2</code></pre>
<p><strong>Software:</strong></p>
<pre><code>Wu, S and Schmitz, U (2025). ScIsoX: Single-Cell Hierarchical Tensor (SCHT) Creation Pipeline
and Transcriptomic Complexity Analysis in R. R package version 1.1.1.
DOI: 10.5281/zenodo.16569860</code></pre>
<p>BibTeX entry:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode bibtex"><code class="sourceCode bibtex"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="va">@article</span>{<span class="ot">Wu2025</span>.<span class="ot">04</span>.<span class="ot">28</span>.<span class="ot">650897</span>,</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>    <span class="dt">author</span> = {Wu, Siyuan and Schmitz, Ulf},</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>    <span class="dt">doi</span> = {10.1101/2025.04.28.650897},</span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>    <span class="dt">eprint</span> = {https://www.biorxiv.org/content/early/2025/05/01/2025.04.28.650897.full.pdf},</span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>    <span class="dt">journal</span> = {bioRxiv},</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>    <span class="dt">title</span> = {{ScIsoX}: A Multidimensional Framework for Measuring Isoform-Level Transcriptomic Complexity in Single Cells},</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a>    <span class="dt">url</span> = {https://www.biorxiv.org/content/early/2025/05/01/2025.04.28.650897},</span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>    <span class="dt">year</span> = {2025}</span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a>}</span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="contact--support">Contact &amp; Support<a class="anchor" aria-label="anchor" href="#contact--support"></a>
</h2>
<div class="section level3">
<h3 id="maintainer">Maintainer<a class="anchor" aria-label="anchor" href="#maintainer"></a>
</h3>
<p>Siyuan Wu (<a href="mailto:thaddeus.wu@jcu.edu.au" class="email">thaddeus.wu@jcu.edu.au</a>)</p>
</div>
<div class="section level3">
<h3 id="contributors">Contributors<a class="anchor" aria-label="anchor" href="#contributors"></a>
</h3>
<ul>
<li>Siyuan Wu (James Cook University)</li>
<li>Ulf Schmitz (James Cook University)</li>
</ul>
</div>
<div class="section level3">
<h3 id="reporting-issues">Reporting Issues<a class="anchor" aria-label="anchor" href="#reporting-issues"></a>
</h3>
<p>Please report bugs and feature requests via the <a href="https://github.com/ThaddeusWu/ScIsoX/issues" class="external-link">GitHub issue tracker</a>.</p>
</div>
<div class="section level3">
<h3 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h3>
<p>This package is licensed under the MIT License.</p>
</div>
<div class="section level3">
<h3 id="acknowledgments">Acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"></a>
</h3>
<p>We gratefully acknowledge Wang et al. (2022) for making their single-cell multiomics data publicly available. The example datasets included in ScIsoX are derived from their publication:</p>
<blockquote>
<p>Wang W, et al. (2022). Single-cell multiomics defines tolerogenic extrathymic Aire-expressing populations. <em>Science Advances</em> 8(1):eabg5369. DOI: 10.1126/sciadv.abg5369</p>
</blockquote>
<p>These datasets are used under the Creative Commons Attribution 4.0 International License (CC BY 4.0).</p>
<hr>
<p><em>ScIsoX: Unlocking the complexity of the transcriptome, one cell at a time.</em></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/ThaddeusWu/ScIsoX/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/ThaddeusWu/ScIsoX/issues" class="external-link">Report a bug</a></li>
<li><a href="https://github.com/ThaddeusWu/ScIsoX/issues" class="external-link">Report an issue</a></li>
<li><a href="https://github.com/ThaddeusWu/ScIsoX/discussions" class="external-link">Ask a question</a></li>
<li><a href="https://doi.org/10.5281/zenodo.16569859" class="external-link">View on Zenodo</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><p><strong>Software DOI:</strong><br><a href="https://doi.org/10.5281/zenodo.16569859" class="external-link"> <img src="https://zenodo.org/badge/DOI/10.5281/zenodo.16569859.svg" alt="DOI"></a><br><br><strong>Manuscript:</strong><br> Wu &amp; Schmitz (2025)<br> bioRxiv: <a href="https://doi.org/10.1101/2025.04.28.650897" class="external-link">10.1101/2025.04.28.650897</a></p></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://github.com/ThaddeusWu" class="external-link"><img src="https://github.com/ThaddeusWu.png" height="24"> Siyuan Wu</a> <br><small class="roles"> Author, maintainer </small>   </li>
<li>
<a href="https://github.com/ulfschmitz" class="external-link"><img src="https://github.com/ulfschmitz.png" height="24"> Ulf Schmitz</a> <br><small class="roles"> Author </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Siyuan Wu, Ulf Schmitz<br> Site built with <a href="https://pkgdown.r-lib.org" class="external-link">pkgdown</a> 2.1.1</p>
</div>

<div class="pkgdown-footer-right">
  <p><strong>Package License</strong>: <a href="https://opensource.org/licenses/MIT" class="external-link">MIT</a><br><br><strong>Example Data Attribution</strong>:<br> The example datasets included in this package are derived from:<br> Wang et al. (2022). Single-cell multiomics defines tolerogenic extrathymic Aire-expressing populations. <em>Science Advances</em> 8(1):eabg5369<br> Licensed under <a href="https://creativecommons.org/licenses/by/4.0/" class="external-link">CC BY 4.0</a><br> We gratefully acknowledge the authors for making their data publicly available.</p>
</div>

    </footer>
</div>





  </body>
</html>
